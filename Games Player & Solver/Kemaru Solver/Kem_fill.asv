function Kem = Kem_fill (dim, Kem, Cage_size)

max_p=max(Cage_size);
Kem(:,:,2:max_p+1)?
Kem=[Kem zeros(dim,dim,max_p-1)];

for i=1:dim % i=line number
    for j=1:dim % j=column number
        if Kem(i,j) == 0 % First fill
            cage_nbr=Kem(i,j,1);
            cage_size=Cage_size(cage_nbr);
            for k=2:cage_size+1
                Kem_p(i,j,k)=k-1;% Adds all possibilities
            end
        end
    end
end

end